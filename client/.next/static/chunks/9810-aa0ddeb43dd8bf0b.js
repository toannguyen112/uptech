"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9810],{9810:function(a,b,c){c.d(b,{Z:function(){return t}});var d=c(7568),e=c(9815),f=c(4051),g=c.n(f),h=c(5893),i=c(5675),j=c.n(i),k=c(7294),l=c(9785),m=function(a){var b=a.onSelectFile,c=a.onRemoveFile,d=a.file;return(0,h.jsxs)("div",{className:"overflow-hidden",children:[(0,h.jsx)("img",{onClick:function(){return b(d)},src:d.path,alt:d.name,className:"w-full h-full"}),(0,h.jsx)("div",{onClick:function(){return c(d)},className:"text-[12px] absolute z-[10] font-bold hidden group-hover:block bottom-1 right-1 py-[4px] px-[20px] text-black border border-black rounded-[4px] bg-white uppercase shadow-input",children:"X\xf3a"})]})},n=c(3861),o=c(4141),p=c(1163),q=c(5600),r=c(2920),s=c(612),t=function(a){var b=a.multiple,c=void 0!==b&&b,f=a.filesSelect,i=a.fileSelect,t=a.onClose,u=a.onSelectFile,v=(0,k.useRef)(),w=(0,p.useRouter)();w.query.id;var x,y,z,A=(0,k.useState)(c?void 0===f?[]:f:void 0===i?{}:i),B=A[0],C=A[1],D=(0,k.useState)(!1),E=D[0],F=D[1],G=(0,k.useState)([]),H=G[0],I=G[1],J=(0,k.useState)([]),K=J[0],L=J[1],M=(0,k.useState)(),N=M[0],O=M[1],P=(0,k.useState)(1),Q=P[0],R=P[1],S=(0,k.useState)(""),T=S[0],U=S[1],V=(0,k.useState)(!1),W=(V[0],V[1]),X=function(){return v.current.click()},Y=(x=(0,d.Z)(g().mark(function a(){var b;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.Z.get("/folders");case 3:O((b=a.sent).data.data),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.error(a.t0);case 10:case"end":return a.stop()}},a,null,[[0,7]])})),function(){return x.apply(this,arguments)}),Z=(y=(0,d.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,W(!0),a.next=4,l.Z.post("/folders/get-medias",{folderId:Q}).then(function(a){L(a.data.data),W(!1)});case 4:a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),W(!0);case 9:case"end":return a.stop()}},a,null,[[0,6]])})),function(){return y.apply(this,arguments)});(0,k.useEffect)(function(){Y()},[]),(0,k.useEffect)(function(){H.length&&ab()},[H]),(0,k.useEffect)(function(){Z()},[Q]);var $,_,aa,ab=(z=(0,d.Z)(g().mark(function a(){var b,c;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=new FormData,c=Q,Array.from(H).forEach(function(a){b.append("files",a)}),b.append("folderId",c),a.next=7,l.Z.post("/medias/create",b).then(function(a){Z()});case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),console.error(a.t0);case 12:case"end":return a.stop()}},a,null,[[0,9]])})),function(){return z.apply(this,arguments)}),ac=function(a){c?B.find(function(b){return b.id===a.id})?C(B.filter(function(b){return b.id!=a.id})):C((0,e.Z)(B).concat([a])):"/admin/medias"!=w.pathname&&(u(a),t(!1))},ad=($=(0,d.Z)(g().mark(function a(b){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.Z.delete("medias/delete/".concat(b.id)).then(function(a){Z(),r.Am.success("X\xf3a File th\xe0nh c\xf4ng !",{position:r.Am.POSITION.TOP_CENTER})}).catch(function(a){});case 2:case"end":return a.stop()}},a)})),function(a){return $.apply(this,arguments)});(0,d.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.Z.delete("/folders/delete/".concat(Q)).then(function(a){a.data&&Y()});case 2:case"end":return a.stop()}},a)}));var ae=(aa=(0,d.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.Z.post("/folders/create",{parent_id:Q,label:T}).then(function(a){F(!1),r.Am.success("Th\xeam thư mục th\xe0nh c\xf4ng !",{position:r.Am.POSITION.TOP_CENTER}),Y(),U("")});case 2:case"end":return a.stop()}},a)})),function(){return aa.apply(this,arguments)}),af=function(){C([])},ag=function(){u(B),t(!1)};return(0,h.jsxs)(k.Fragment,{children:[(0,h.jsxs)(n.V,{header:"Tạo Folder",visible:E,style:{width:"50vw"},onHide:function(){return F(!1)},children:[(0,h.jsxs)("div",{className:"space-y-[8px]",children:[(0,h.jsx)("label",{htmlFor:"",children:"T\xean Folder:"}),(0,h.jsx)(q.o,{value:T,onChange:function(a){return U(a.target.value)},className:"w-full"})]}),(0,h.jsx)("div",{className:"flex justify-end",children:(0,h.jsx)("button",{className:"btn btn-prime mt-[20px]",onClick:function(){return ae()},children:"Tạo"})})]}),(0,h.jsxs)("div",{className:"fixed top-0 bottom-0 right-0 z-50 overflow-hidden bg-white left-from-sidebar",children:[c&&B.length?(0,h.jsxs)("div",{className:"absolute z-[10] bottom-0 inset-x-0 bg-white border-t border-gray-200 flex items-center justify-center py-[1rem] space-x-[12px]",children:[(0,h.jsx)("button",{onClick:function(){return af()},className:"btn-gray-outline uppercase",children:"Bỏ chọn"}),(0,h.jsxs)("button",{onClick:function(){return ag()},className:"btn-gray-outline uppercase",children:["Chọn (",B.length,")"]})]}):"",(0,h.jsxs)("div",{className:"absolute inset-x-0 h-[80px] flex justify-between bg-white border-b border-gray-200 py-[1rem] px-[2rem] items-center",children:[(0,h.jsxs)("div",{className:"text-gray-900 font-medium flex items-center space-x-[10px]",children:["/admin/medias"!==w.pathname&&(0,h.jsx)("button",{onClick:function(){return t(!1)},className:"cursor-pointer",children:(0,h.jsx)("img",{src:"/svg/arrow.svg",className:"rotate-90"})}),(0,h.jsx)("span",{children:"File Maneger"})]}),(0,h.jsxs)("div",{className:"flex items-center space-x-[8px]",children:[(0,h.jsx)("div",{className:"p-[8px] border border-gray-400 rounded-[12px] min-w-[400px] bg-white",children:(0,h.jsx)("input",{className:"border-none w-full focus:outline-none placeholder:text-gray-400",multiple:!0,placeholder:"Nhập t\xean tệp...",type:"text"})}),(0,h.jsx)("button",{onClick:function(){return F(!0)},className:"btn-prime",children:(0,h.jsx)(s.Z,{id:"page.admin.btn_create_folder"})}),(0,h.jsxs)("button",{onClick:X,className:"btn-prime",children:[(0,h.jsx)(j(),{src:"/svg/upload.svg",alt:"upload",width:"20",height:"20",className:"text-white"}),(0,h.jsx)("div",{children:(0,h.jsx)(s.Z,{id:"page.admin.btn_choosen_folder"})})]})]})]}),(0,h.jsx)("input",{ref:v,style:{display:"none"},multiple:!0,type:"file",onChange:function(a){I(a.target.files)}}),(0,h.jsxs)("div",{className:"pt-[80px] grid grid-cols-12 bg-white h-full",children:[(0,h.jsx)("div",{className:"col-span-4 border-r border-gray-200 py-[20px] px-4",children:(0,h.jsx)(o.m,{value:N,selectionMode:"single",selectionKeys:Q,onSelectionChange:function(a){return R(a.value)},className:"w-full md:w-30rem"})}),(0,h.jsx)("div",{className:"col-span-8 overflow-y-auto py-[20px] px-4 h-screen max-h-screen pb-[200px]",children:(0,h.jsx)("div",{className:"grid grid-cols-4 gap-[8px] ",children:K&&K.length?K.map(function(a,b){return(0,h.jsx)("div",{className:"col-span-1 h-[200px] \n                      flex items-center justify-center bg-gray-100\n                      group aspect-w-1 aspect-h-1 border border-gray-300 rounded-[8px] \n                      overflow-hidden  \n                      cursor-pointer group-hover:border-prime relative \n                      ".concat(c&&B.find(function(b){return b.id===a.id})?"border-prime":""),children:(0,h.jsx)(m,{onSelectFile:ac,onRemoveFile:ad,file:a})},b)}):""})})]})]})]})}}}])